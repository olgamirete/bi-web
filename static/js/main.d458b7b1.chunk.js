(this.webpackJsonpweb=this.webpackJsonpweb||[]).push([[0],[,,,,function(e,t,a){e.exports=a(18)},,,,,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(3),s=a.n(r),c=(a(9),a(1));a(10);var l=function(){var e=Object(n.useState)(!0),t=Object(c.a)(e,2),a=t[0],o=t[1],r=Object(n.useState)(!1),s=Object(c.a)(r,2),l=s[0],i=s[1],d=Object(n.useState)(!0),u=Object(c.a)(d,2),p=u[0],f=u[1],h=Object(n.useState)(!1),g=Object(c.a)(h,2),m=g[0],b=g[1],v=Object(n.useCallback)((function(){o((function(e){return!e}))}),[]),w=Object(n.useCallback)((function(){i((function(e){return!e}))}),[]),E=Object(n.useCallback)((function(){f((function(e){return!e}))}),[]),S=Object(n.useCallback)((function(){b((function(e){return!e}))}),[]);return[{showSidePanel:a,snapToGrid:l,displayGrid:p,allowSelection:m},{setFlagShowSidePanel:o,toggleSidePanel:v,toggleSnapToGrid:w,toggleDisplayGrid:E,toggleFlagAllowSelection:S,setFlagAllowSelection:b}]},i={width:120,height:180};var d=function(e){var t=Object(n.useState)({past:[],present:new Map,future:[]}),a=Object(c.a)(t,2),o=a[0],r=a[1],s=Object(n.useState)(0),l=Object(c.a)(s,2),d=l[0],u=l[1],p=Object(n.useCallback)((function(t,a){var n={left:e.snapToGrid?20*Math.round(a.left/20,0):a.left,top:e.snapToGrid?20*Math.round(a.top/20,0):a.top};r((function(e){var a=e.present.get(t),o=new Map(e.present);return o.set(t,{id:a.id,pos:n,size:a.size,propsBeforeChange:a.propsBeforeChange,selected:a.selected,flags:a.flags}),{past:e.past.concat([e.present]),present:o,future:[]}}))}),[e.snapToGrid]),f=Object(n.useCallback)((function(t){r((function(a){var n=new Map(a.present);return n.forEach((function(a){if(!0===a.selected){var o=a.propsBeforeChange.pos,r={left:o.left+t.x,top:o.top+t.y},s={left:e.snapToGrid?20*Math.round(r.left/20,0):r.left,top:e.snapToGrid?20*Math.round(r.top/20,0):r.top};n.set(a.id,{id:a.id,pos:s,size:a.size,propsBeforeChange:a.propsBeforeChange,selected:a.selected,flags:a.flags})}})),{past:a.past,present:n,future:a.future}}))}),[e.snapToGrid]),h=Object(n.useCallback)((function(t,a,n,o){r((function(r){var s=r.present.get(t),c=s.propsBeforeChange.size,l=s.propsBeforeChange.pos,i={left:o.right?Math.min(l.left+a.x,l.left+c.width-40):l.left,top:o.bottom?Math.min(l.top+a.y,l.top+c.height-40):l.top},d={left:e.snapToGrid&&o.right&&n.width?20*Math.round(i.left/20,0):i.left,top:e.snapToGrid&&o.bottom&&n.height?20*Math.round(i.top/20,0):i.top},u={width:Math.max(c.width+a.x*(o.right?-1:1),40),height:Math.max(c.height+a.y*(o.bottom?-1:1),40)},p=u.width,f=u.height;e.snapToGrid&&(n.width&&(p=o.right?c.width-(d.left-l.left):20*Math.round((l.left+u.width)/20,0)-l.left),n.height&&(f=o.bottom?c.height-(d.top-l.top):20*Math.round((l.top+u.height)/20,0)-l.top));var h={width:p,height:f},g=new Map(r.present);return g.set(t,{id:s.id,pos:d,size:h,propsBeforeChange:s.propsBeforeChange,selected:s.selected,flags:s.flags}),{past:r.past,present:g,future:r.future}}))}),[e.snapToGrid]),g=Object(n.useCallback)((function(e){r((function(t){var a=t.present.get(e),n=new Map(t.present);return n.set(e,{id:a.id,pos:a.pos,size:a.size,propsBeforeChange:a.propsBeforeChange,selected:!a.selected,flags:a.flags}),{past:t.past,present:n,future:t.future}}))}),[]),m=Object(n.useCallback)((function(e,t){void 0===t&&(t=i),r((function(a){var n=new Map(a.present),o="card-"+d;return n.set(o,{id:o,pos:e,size:t,propsBeforeChange:{pos:e,size:t},selected:!1,flags:{allowResize:{width:!1,height:!1},allowMove:!1}}),{past:a.past.concat([a.present]),present:n,future:[]}})),u((function(e){return e+1}))}),[d]),b=Object(n.useCallback)((function(e){r((function(t){var a=new Map(t.present);return a.delete(e),{past:t.past.concat([t.present]),present:a,future:[]}}))}),[]),v=Object(n.useCallback)((function(){r((function(e){var t=!1,a=new Map(e.present);return a.forEach((function(e){!0===e.selected&&(a.delete(e.id),t=!0)})),{past:t?e.past.concat([e.present]):e.past,present:t?a:e.present,future:t?[]:e.future}}))}),[]),w=Object(n.useCallback)((function(){r((function(e){var t=new Map(e.present);return t.forEach((function(e){t.set(e.id,{id:e.id,pos:e.pos,size:e.size,propsBeforeChange:{pos:e.pos,size:e.size},selected:e.selected,flags:e.flags})})),{past:e.past.concat([e.present]),present:t,future:[]}}))}),[]),E=Object(n.useCallback)((function(){r((function(e){var t=new Map(e.present);return t.forEach((function(e){!0===e.selected&&t.set(e.id,{id:e.id,pos:e.pos,size:e.size,propsBeforeChange:e.propsBeforeChange,selected:!1,flags:e.flags})})),{past:e.past,present:t,future:e.future}}))}),[]),S=Object(n.useCallback)((function(e){return!0===o.present.has(e)?o.present.get(e).selected:Error("cardId does not exist.")}),[o.present]),O=Object(n.useCallback)((function(e,t,a){var n=a.pos,o=a.size,r=e.left>=n.left&&e.left+t.width<=n.left+o.width,s=e.top>=n.top&&e.top+t.height<=n.top+o.height;return r&&s}),[]),j=Object(n.useCallback)((function(e,t){r((function(a){var n=new Map(a.present);return n.forEach((function(a){var o=O(a.pos,a.size,e);n.set(a.id,{id:a.id,pos:a.pos,size:a.size,propsBeforeChange:a.propsBeforeChange,selected:t?o||a.selected:o,flags:a.flags})})),{past:a.past,present:n,future:a.future}}))}),[O]),y=Object(n.useCallback)((function(){r((function(e){return{past:e.past.length>0?e.past.slice(0,e.past.length-1):e.past,present:e.past.length>0?e.past[e.past.length-1]:e.present,future:e.past.length>0?e.future.concat([e.present]):e.future}}))}),[]),N=Object(n.useCallback)((function(){r((function(e){return{past:e.future.length>0?e.past.concat([e.present]):e.past,present:e.future.length>0?e.future[e.future.length-1]:e.present,future:e.future.length>0?e.future.slice(0,e.future.length-1):e.future}}))}),[]),M={canUndo:o.past.length>0,canRedo:o.future.length>0},C={add:m,move:p,translateSelected:f,resize:h,__updatePropsBeforeChange:w,isSelected:S,toggleSelect:g,clearSelection:E,delete:b,deleteSelected:v,selectWithRectangle:j,undo:y,redo:N};return[o.present,M,C]};var u=function(){var e=new Map;return e.set("table1",{id:"table1",fields:["anio","nombre","cantidad"]}),e.set("table2",{id:"table2",fields:["dni","provincia","edad"]}),e.set("table3",{id:"table3",fields:["fruta","calor\xedas"]}),[e,null]};a(11);var p=function(e){return o.a.createElement("div",{className:"controls"},o.a.createElement("button",{className:"button"+(e.cardFlags.canUndo?"":" disabled"),onPointerDown:e.cardMethods.undo},"Undo"),o.a.createElement("button",{className:"button"+(e.cardFlags.canRedo?"":" disabled"),onPointerDown:e.cardMethods.redo},"Redo"),o.a.createElement("button",{className:"button",onPointerDown:e.controlMethods.toggleSidePanel},"Toggle menu"),o.a.createElement("button",{alt:"Toggle snap to grid",className:"button"+(e.controlFlags.snapToGrid?" active":""),onPointerDown:e.controlMethods.toggleSnapToGrid},"Snap to grid"),o.a.createElement("button",{alt:"Toggle display grid",className:"button"+(e.controlFlags.displayGrid?" active":""),onPointerDown:e.controlMethods.toggleDisplayGrid},"Display grid"),o.a.createElement("button",{className:"button",onPointerDown:function(){return e.cardMethods.add({left:100,top:300})}},"+"),o.a.createElement("button",{className:"button"+(e.controlFlags.allowSelection?" active":""),onPointerDown:e.controlMethods.toggleFlagAllowSelection},"Select"),o.a.createElement("button",{className:"button",onPointerDown:e.cardMethods.deleteSelected},"Delete"))};a(12),a(13);var f=function(e){var t=Object(n.useState)(!1),a=Object(c.a)(t,2),r=a[0],s=a[1];return o.a.createElement("section",{className:"table-fields-section"},o.a.createElement("div",{className:"container-button-and-title"},o.a.createElement("button",{className:"button-expand-collapse",onPointerUp:function(e){e.target.innerHTML=r?"+":"-",s(!r)}},"+"),o.a.createElement("h4",{id:e.tableStructure.id,className:"fields-table-name"},e.tableStructure.id)),o.a.createElement("ul",{className:"fields-list"+(r?"":" hidden")},e.tableStructure.fields.map((function(t,a,n){return o.a.createElement("li",{key:a,id:"table-"+e.tableStructure.id+"-field-"+t,className:"field-item"},t)}))))};var h=function(e){var t=Object(n.useState)("fields"),a=Object(c.a)(t,2),r=a[0],s=a[1],l=function(t){var a=t.target.dataset.section;void 0===a&&(a=t.target.parentNode.dataset.section),r!==a?(s(a),e.controlMethods.setFlagShowSidePanel(!0)):e.controlMethods.toggleSidePanel()};return o.a.createElement("div",{className:"side-panel"+(e.controlFlags.showSidePanel?"":" hide")},o.a.createElement("div",{className:"buttons-container"},o.a.createElement("button",{"data-section":"fields",className:"fields"===r?"active":"",onPointerDown:l},o.a.createElement("span",{className:"text"},"Fields")),o.a.createElement("button",{"data-section":"format",className:"format"===r?"active":"",onPointerDown:l},o.a.createElement("span",{className:"text"},"Format")),o.a.createElement("button",{"data-section":"other",className:"other"===r?"active":"",onPointerDown:l},o.a.createElement("span",{className:"text"},"Other"))),o.a.createElement("div",{className:"sections-container"},o.a.createElement("section",{className:"section"+("fields"===r?" active":"")},o.a.createElement("h3",{className:"title"},"Fields"),Array.from(e.dataStructure.values()).map((function(e,t,a){return o.a.createElement(f,{key:t,tableStructure:e})}))),o.a.createElement("section",{className:"section"+("format"===r?" active":"")},o.a.createElement("h3",{className:"title"},"Format"),"Format options"),o.a.createElement("section",{className:"section"+("other"===r?" active":"")},o.a.createElement("h3",{className:"title"},"Other"),"Other")))};a(14),a(15);var g=function(e){var t=e.cardInfo.selected;return o.a.createElement("div",{id:e.cardInfo.id,className:"resizeable-card-container"+(t?" selected":"")+(e.controlFlags.snapToGrid?" animate-all":"")+(e.dashboardFlags.overrideHoverPointers?" unset-cursors":""),style:{left:e.cardInfo.pos.left+"px",top:e.cardInfo.pos.top+"px",backgroundColor:e.color}},o.a.createElement("div",{className:"col-container"},o.a.createElement("div",{className:"corner nw","data-anchor":{right:!0,bottom:!0}}),o.a.createElement("div",{className:"border vertical left","data-anchor":{right:!0,bottom:!1}}),o.a.createElement("div",{className:"corner sw","data-anchor":{right:!0,bottom:!1}})),o.a.createElement("div",{className:"col-container"},o.a.createElement("div",{className:"border horizontal top","data-anchor":{right:!1,bottom:!0}}),o.a.createElement("div",{className:"content",style:{width:e.cardInfo.size.width+"px",height:e.cardInfo.size.height+"px"}}),o.a.createElement("div",{className:"border horizontal bottom","data-anchor":{right:!1,bottom:!1}})),o.a.createElement("div",{className:"col-container"},o.a.createElement("div",{className:"corner ne","data-anchor":{right:!1,bottom:!0}}),o.a.createElement("div",{className:"border vertical right","data-anchor":{right:!1,bottom:!1}}),o.a.createElement("div",{className:"corner se","data-anchor":{right:!1,bottom:!1}})))};var m=function(e,t,a,o){var r=Object(n.useState)({width:!1,height:!1}),s=Object(c.a)(r,2),l=s[0],i=s[1],d=Object(n.useState)(!1),u=Object(c.a)(d,2),p=u[0],f=u[1],h=Object(n.useState)({x:0,y:0}),g=Object(c.a)(h,2),m=g[0],b=g[1],v=Object(n.useState)({right:!1,bottom:!1}),w=Object(c.a)(v,2),E=w[0],S=w[1],O=Object(n.useState)(null),j=Object(c.a)(O,2),y=j[0],N=j[1],M=Object(n.useState)(!1),C=Object(c.a)(M,2),z=C[0],k=C[1],F=Object(n.useState)(!1),P=Object(c.a)(F,2),B=P[0],x=P[1],D=Object(n.useState)({flagDraw:!1,pos:{left:0,top:0},size:{width:0,height:0}}),T=Object(c.a)(D,2),G=T[0],I=T[1],R=Object(n.useState)(!1),L=Object(c.a)(R,2),A=L[0],K=L[1],X=Object(n.useCallback)((function(t,a,n,o){var r="";if(t)r=n?"ns-resize":"ew-resize";else if(a){r={"00":"se-resize","01":"ne-resize",10:"sw-resize",11:"nw-resize"}[[+o.right,+o.bottom].join("")]}else r="normal";document.getElementById(e).style.setProperty("cursor",r)}),[e]),Y=Object(n.useCallback)((function(){document.getElementById(e).style.removeProperty("cursor")}),[e]),U=Object(n.useCallback)((function(e){for(var t=e;t;){if(Array.from(t.classList).includes("resizeable-card-container"))return t;t=t.parentElement}return null}),[]);Object(n.useEffect)((function(){var n=document.getElementById(e),o=function(e){e.preventDefault(),K(!0),b({x:e.pageX,y:e.pageY});var o=U(e.target);if(null!==o){t.__updatePropsBeforeChange(),N(o);var r=o.id;if(!0===e.shiftKey)t.toggleSelect(r);else{!1===t.isSelected(r)&&(t.clearSelection(),t.toggleSelect(r));var s=Array.from(e.target.classList),c=s.includes("border"),l=s.includes("corner");if(c||l){var d=s.includes("horizontal"),u=["left","nw","sw"],p=s.some((function(e){return u.includes(e)})),h=["top","nw","ne"],g={right:p,bottom:s.some((function(e){return h.includes(e)}))};S(g),i({width:!d||l,height:d||l}),X(c,l,d,g),k(!0)}else f(!0)}}else if(!0===e.ctrlKey){var m=n.getBoundingClientRect();t.add({left:e.pageX-m.left+n.scrollLeft,top:e.pageY-m.top+n.scrollTop})}else e.shiftKey||t.clearSelection(),"touch"!==e.pointerType&&a.setFlagAllowSelection(!0)};return n.addEventListener("pointerdown",o,!1),function(){return n.removeEventListener("pointerdown",o,!1)}}),[t,e,X,U,a]),Object(n.useLayoutEffect)((function(){var a=document.getElementById(e),n=function(e){e.preventDefault();var n={x:e.pageX-m.x,y:e.pageY-m.y};if(p)if(!1===e.shiftKey)t.translateSelected(n);else{var r=Math.abs(n.x)>Math.abs(n.y),s={x:r?n.x:0,y:!r?n.y:0};t.translateSelected(s)}else if(l.width||l.height){var c={x:l.width?n.x:0,y:l.height?n.y:0};t.resize(y.id,c,l,E)}else if(A&&o.allowSelection){var i=a.getBoundingClientRect(),d={flagDraw:!0,pos:{left:Math.min(m.x,e.pageX)-i.left+a.scrollLeft,top:Math.min(m.y,e.pageY)-i.top+a.scrollTop},size:{width:Math.abs(e.pageX-m.x),height:Math.abs(e.pageY-m.y)}};I(d);var u=e.shiftKey;t.selectWithRectangle(d,u)}};return a.addEventListener("pointermove",n,!1),function(){return a.removeEventListener("pointermove",n,!1)}}),[t,e,p,l,E,m,y,A,o.allowSelection]),Object(n.useEffect)((function(){var t=document.getElementById(e),n=function(e){K(!1),i({width:!1,height:!1}),f(!1),Y(),k(!1),I({flagDraw:!1,pos:{left:0,top:0},size:{width:0,height:0}}),a.setFlagAllowSelection(!1)};return t.addEventListener("pointerup",n,!1),function(){return t.removeEventListener("pointerup",n,!1)}}),[t,e,Y,a]),Object(n.useEffect)((function(){var e=function(e){switch(e.key){case"Escape":t.clearSelection();break;case"Delete":t.deleteSelected();break;case"Control":B||(a.toggleSnapToGrid(),x(!0));break;case"Backspace":t.deleteSelected()}},n=function(e){switch(e.key){case"Escape":case"Delete":break;case"Control":a.toggleSnapToGrid(),x(!1)}};return window.addEventListener("keydown",e,!1),window.addEventListener("keyup",n,!1),function(){window.removeEventListener("keydown",e,!1),window.removeEventListener("keyup",n,!1)}}),[t,a,B]);var W=JSON.stringify({allowResize:l,allowMove:p,lastClickedPos:m,anchor:E});return[{overrideHoverPointers:z,allowRectangleSelect:o.allowSelection,pointerDown:A},{debugInfo:W,selectionRectangleProps:G}]};a(16);var b=function(e){return o.a.createElement("div",{className:"selection-rectangle"+(e.selRectInfo.flagDraw?"":" hide"),style:{left:e.selRectInfo.pos.left,top:e.selRectInfo.pos.top,width:e.selRectInfo.size.width,height:e.selRectInfo.size.height}})};a(17);var v=function(e){return o.a.createElement("div",{className:"grid"},!0===e.controlFlags.displayGrid&&o.a.createElement("span",null,o.a.createElement("div",{className:"small-grid"}),o.a.createElement("div",{className:"big-grid"})))};var w=function(e){var t=Object(n.useRef)(null),a=m("dashboard-content",e.cardMethods,e.controlMethods,e.controlFlags),r=Object(c.a)(a,2),s=r[0],l=r[1];return o.a.createElement("div",{id:"dashboard-content",className:"dashboard-content"+(s.allowRectangleSelect?" touch-action-none":""),ref:t},o.a.createElement(v,{controlFlags:e.controlFlags,controlProps:e.controlProps,dashboardRef:t}),Array.from(e.cards.values()).map((function(t,a,n){return o.a.createElement(g,{key:a,cardInfo:t,dashboardFlags:s,controlFlags:e.controlFlags})})),o.a.createElement(b,{selRectInfo:l.selectionRectangleProps}))};var E=function(){var e=l(),t=Object(c.a)(e,2),a=t[0],n=t[1],r=d(a),s=Object(c.a)(r,3),i=s[0],f=s[1],g=s[2],m=u(),b=Object(c.a)(m,2),v=b[0],E=b[1];return o.a.createElement("div",{className:"App"},o.a.createElement(p,{cardFlags:f,cardMethods:g,controlFlags:a,controlMethods:n}),o.a.createElement("div",{className:"container-for-side-panel-and-content"},o.a.createElement(h,{controlFlags:a,controlMethods:n,dataStructure:v}),o.a.createElement(w,{cards:i,cardMethods:g,controlFlags:a,controlMethods:n,data:E})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(E,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}],[[4,1,2]]]);
//# sourceMappingURL=main.d458b7b1.chunk.js.map